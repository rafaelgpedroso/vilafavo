# Vila Favo - Mobilidade Urbana
![alt text](https://raw.githubusercontent.com/rafaelgpedroso/vilafavo/master/img/init.jpg)
Vila Favo é um jogo educativo sobre mobilidade urbana do gênero dos jogos de estratégia voltado para TVs digitais conectadas, sendo elaborado para o desenvolvimento em Ginga-NCL. O ambiente do jogo é o interior de uma simpática colmeia, onde as abelhas vão desenvolver uma sociedade muito parecida com a dos seres humanos: uma cidade chamada Vila Favo, que viverá problemas de mobilidade urbana característicos das grandes cidades do mundo. O desafio do jogo é implantar ações de melhorias da circulação na cidade criando uma estrutura de mobilidade sustentável, garantindo inclusão social, acessibilidade, preservação do meio ambiente e qualidade de vida para a população. Em cada fase do jogo, Vila Favo vai crescer um pouco mais e, de maneira prática, o jogador poderá utilizar os recursos econômicos gerados na cidade para implantar soluções como linhas de transporte coletivo, corredores e faixas exclusivas para ônibus, ciclovias e ciclofaixas, identificando estrategicamente as melhores escolhas para problemas específicos de mobilidade, e observando indicadores de acidentes, congestionamento e poluição, além de investir em projetos de acessibilidade e inclusão.
![alt text](https://raw.githubusercontent.com/rafaelgpedroso/vilafavo/master/img/select.jpg)
## Instalação
### Com emulador Ginga
A maneira mais prática de executar o teste do jogo Vila Favo é com o Astrobox, emulador Ginga gratuito compatível com a implementação Ginga de marcas populares de aparelhos de TV. O teste assim evita problemas com implementações incorretas de alguns aparelhos.
O Astrobox necessita de uma máquina virtual para ser executado. O roteiro a seguir explica a instalação e configuração do jogo no Astrobox, utilizando o VirtualBox, software gratuito para virtualização.
• Baixar o instalador pelo endereço virtualbox.org (o instalador para sistema Windows já está disponibilizado na pasta Recursos do projeto);
• Efetuar a instalação nas configurações padrão, inclusive com a instalação das interfaces virtuais de rede;
• Copiar o arquivo de disco virtual do Astrobox (AstroBox-RC4-19102011.vmdk) disponibilizado na pasta Recursos do projeto. O Astrobox pode ser baixado também do site oficial astrodevnet.com.br;
• Executar o VirtualBox e criar uma nova máquina virtual com as seguintes configurações:
Utilize o Modo Expert Nome: Astrobox Tipo: Linux Versão: Ubuntu (32-bit) Tamanho da memória: 1024 MB Marcar opção ‘Utilizar um disco rígido virtual existente’ e no caminho do arquivo selecionar o disco do Astrobox já copiado.
• Inicializar a máquina virtual. Utilize para login o nome de usuário ‘totvs’ e a senha ‘astrobox’. Pode ser necessário modificar as configurações de interface de rede da máquina no VirtualBox para que tenha acesso à Internet de dentro da máquina virtual (Recomendável: NAT).
• Na área de trabalho haverá um atalho para a pasta ‘Aplications’. A pasta com os arquivos fonte do projeto deve ser copiada para essa pasta. No arquivo de disco virtual do Astrobox fornecido, os arquivos já estão inseridos na pasta.
• Criar o entry point da aplicação Ginga. Na área de trabalho executar o arquivo ‘Astrobox Configure’, selecionar aplicação do tipo NCL, full-seg e digitar o caminho para o arquivo de início game/main.ncl. No arquivo de disco virtual do Astrobox fornecido, o entrypoint já está configurado.
• Executar o Astrobox. O jogo será carregado no Astrobox.
Notas:
• O Astrobox não tem suporte a mídias de áudio em NCL, portanto a trilha sonora é o único recurso do jogo que não pode ser verificado pelo teste com o emulador.
• O Ginga4Windows, implementação de referência do Ginga não pode ser utilizado para executar Vila Favo porque demonstrou não poder garantir performance para rodar o jogo em taxa próxima a 30 quadros por segundo, e ainda possui falhas de não disponibilizar algumas funções de canvas do Lua imprescindíveis para a execução do projeto e que estão previstas na norma ABNT NBR 15606.
![alt text](https://raw.githubusercontent.com/rafaelgpedroso/vilafavo/master/img/game.png)
### Execução em televisores
Para executar Vila Favo em uma televisão conectada com Ginga embarcado é necessário enviar o pacote do jogo em um transport stream no padrão do SBTVD a ser decodificado pelo aparelho. A forma de gerar o transport stream, criar as tabelas que compõem o sinal e a configuração do entry point da aplicação Ginga dependem do multiplexador utilizado.
Quando o aparelho de TV receber a aplicação pelo canal de dados, o jogo será iniciado automaticamente sobrepondo áudio e vídeo.
Nota: devido ao universo das TVs conectadas ser bastante diverso com relação aos recursos do Ginga que são suportados pelos aparelhos, pode ocorrer de Vila Favo não poder ser executado em alguns televisores mesmo esses possuindo implementação do middleware. Isso ocorre por conta de diversas implementações disponíveis no mercado que não atendem em 100% à norma ABNT NBR 15606. É importante ressaltar também que Vila Favo tem como requisito dispositivos que possuam 6MB de espaço de armazenamento para o Ginga e 32 MB de memória gráfica.
Execução do jogo
O jogo executa diretamente na tela inical, ocupando toda a extensão da tela da TV. São utilizadas pela interface somente botões de setas e o OK do controle remoto. Os botões coloridos são empregados apenas para funções específicas explicadas a baixo. No caso de teste no Astrobox, devem ser utilizadas as setas do teclado, o botão Enter como OK e os botões F1,F2,F3 e F4 emulando os botões coloridos do televisor Ginga, vermelho, verde, amarelo e azul, respectivamente.
